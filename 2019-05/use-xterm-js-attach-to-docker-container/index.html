<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="unihon's blogs"><title>use-xterm-js-attach-to-docker-container | unihon's</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.2.2"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">use-xterm-js-attach-to-docker-container</h1><a id="logo" href="/.">unihon's</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/about/"><i class="fa fa-id-card-o"> About</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">use-xterm-js-attach-to-docker-container</h1><div class="post-meta">May 9, 2019<span> | </span><span class="category"><a href="/categories/Docker/">Docker</a></span></div><div class="post-content"><p>使用 <code>xterm.js</code> “attach” 到 docker 的容器。</p>
<a id="more"></a>
<h1 id="xterm-js"><a href="#xterm-js" class="headerlink" title="xterm.js"></a>xterm.js</h1><p><code>xterm.js</code> 是一个前端组件，可以在中浏览器提供功能齐全的“终端”。只要，使用相关插件和提供相关功能的后端模块，就可以使用 <code>xterm.js</code> 在 web 中接入到 linux，除此，还能够接入到 docker 的容器。</p>
<p>xterm.js 已经“自带”了相关的后端和插件，如 <code>Terminado</code>，如果需要也可以自己开发一个。</p>
<h2 id="xterm-js-插件"><a href="#xterm-js-插件" class="headerlink" title="xterm.js 插件"></a>xterm.js 插件</h2><ul>
<li>attach：用于 attach 到 docker 容器</li>
<li>fit：自适应，指终端的窗口自适应，内容自动调整</li>
<li>fullscreen：全屏</li>
<li>terminado：用于和 xterm.js 的后端 Terminado 一起使用</li>
</ul>
<h1 id="使用-xterm-js-接入-linux"><a href="#使用-xterm-js-接入-linux" class="headerlink" title="使用 xterm.js 接入 linux"></a>使用 xterm.js 接入 linux</h1><p>xterm.js 官网给了两个使用 Terminado 的例子，主要的区别是关于 xterm.js 的引用方式，这部分可以使用传统的方式直接引用 xterm.js 的 js 文件，也可以使用 ES6 的语法，引用相关模块，再“编译”。实际上 xterm.js 首推的是使用 ES6 的语法，不过这个例子我是直接引用预先“编译”好的 js 文件。</p>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><p>首先新建一个项目，下载、安装 xterm.js 和 Terminado。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save xterm</span><br><span class="line">pip install terminado</span><br></pre></td></tr></table></figure>
<p>然后将 xterm.js 预先“编译”好的目标文件 <code>./node_modules/xterm/dist/</code> 复制到项目 root 目录。</p>
<p>接着在项目 root 目录下添加一个后端文件 <code>app.py</code> 和一个前端文件 <code>index.html</code>。</p>
<p><strong>app.py</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/usr/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line"><span class="keyword">from</span> tornado.ioloop <span class="keyword">import</span> IOLoop</span><br><span class="line"><span class="keyword">from</span> terminado <span class="keyword">import</span> TermSocket, SingleTermManager</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    term_manager = SingleTermManager(shell_command=[<span class="string">'bash'</span>])</span><br><span class="line">    handlers = [</span><br><span class="line">                (<span class="string">r"/websocket"</span>, TermSocket, &#123;<span class="string">'term_manager'</span>: term_manager&#125;),</span><br><span class="line">                (<span class="string">r"/()"</span>, tornado.web.StaticFileHandler, &#123;<span class="string">'path'</span>:<span class="string">'index.html'</span>&#125;),</span><br><span class="line">                (<span class="string">r"/(.*)"</span>, tornado.web.StaticFileHandler, &#123;<span class="string">'path'</span>:<span class="string">'.'</span>&#125;),</span><br><span class="line">               ]</span><br><span class="line">    app = tornado.web.Application(handlers)</span><br><span class="line">    app.listen(<span class="number">8010</span>)</span><br><span class="line">    IOLoop.current().start()</span><br></pre></td></tr></table></figure>
<p><strong>index.html</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"/dist/xterm.css"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/dist/xterm.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/dist/addons/terminado/terminado.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"terminal-container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">      terminado.apply(Terminal);</span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> term = <span class="keyword">new</span> Terminal(),</span></span><br><span class="line"><span class="javascript">          protocol = (location.protocol === <span class="string">'https:'</span>) ? <span class="string">'wss://'</span> : <span class="string">'ws://'</span>,</span></span><br><span class="line"><span class="javascript">          socketURL = protocol + location.hostname + ((location.port) ? (<span class="string">':'</span> + location.port) : <span class="string">''</span>) + <span class="string">"/websocket"</span>;</span></span><br><span class="line"><span class="javascript">          sock = <span class="keyword">new</span> WebSocket(socketURL);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      sock.addEventListener(<span class="string">'open'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line">        term.terminadoAttach(sock);</span><br><span class="line">      &#125;);</span><br><span class="line"></span><br><span class="line"><span class="javascript">      term.open(<span class="built_in">document</span>.getElementById(<span class="string">'terminal-container'</span>));</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>最后运行 <code>app.py</code>。</p>
<img src="/2019-05/use-xterm-js-attach-to-docker-container/2019-05-09_xterm_ado.jpg">
<p>▲ xterm.js 接入 linux 效果</p>
<p>项目的关键文件为 <code>app.py</code>、<code>index.html</code> 及已经预先“编译”好的 xterm.js 目标 js 文件 <code>dist/</code></p>
<h1 id="使用-xterm-js-attach-到-docker-容器"><a href="#使用-xterm-js-attach-到-docker-容器" class="headerlink" title="使用 xterm.js attach 到 docker 容器"></a>使用 xterm.js attach 到 docker 容器</h1><p>这部分使用 ES6 的方式引用 xterm.js，实际尝试过直接引用预先“编译”好的 js 文件，不过并没能成功，而官网也没“传统”引用方法的示例（这部分），所以还是直接选择“避坑”吧…</p>
<h2 id="步骤-1"><a href="#步骤-1" class="headerlink" title="步骤"></a>步骤</h2><p>同样的新建一个项目，因为浏览器目前对 ES6 并不能 100% 支持，所以需要下载 <code>webpack</code>、<code>webpack-cli</code>、<code>webpack-dev-server</code>，用于打包（编译）、调试 js。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev webpack webpack-cli webpack-dev-server</span><br></pre></td></tr></table></figure>
<p>接着下载 xterm.js。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save xterm</span><br></pre></td></tr></table></figure>
<img src="/2019-05/use-xterm-js-attach-to-docker-container/2019-05-09_xterm_attach_pack.jpg">
<p>▲ 项目包含的包（package.json）</p>
<h3 id="配置-package-json-和-webpack"><a href="#配置-package-json-和-webpack" class="headerlink" title="配置 package.json 和 webpack"></a>配置 package.json 和 webpack</h3><p><strong>package.json</strong></p>
<p>配置 npm 脚本，修改根目录下的 <code>package.json</code> ，在 <code>scripts</code> 添加如下内容。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">        <span class="attr">"dev"</span>: <span class="string">"webpack-dev-server"</span>,</span><br><span class="line">        <span class="attr">"build"</span>: <span class="string">"webpack --progress --mode=development"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>webpack.config.js</strong></p>
<p>配置 webpack，在项目根目录下修改 webpack.config.js 文件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'dist/bundle.js'</span>,</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'./'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        contentBase: path.join(__dirname, <span class="string">"./"</span>),</span><br><span class="line">        compress: <span class="literal">true</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意：<br><code>output</code> 里的 <code>path</code> 为打包后的目标文件的路径，<code>devServer</code> 里的 <code>contentBase</code> 为 webpack-dev-Server 指定的 web root 目录，这两个需要一样，不然“热更新”可能无效。</p>
</blockquote>
<p>开发环境配置好后，就可以进入主题了。</p>
<p>根据前面 <code>webpack.config.js</code> 的配置，在项目根目录下新建入口文件 <code>./src/index.js</code>。</p>
<p><strong>./src/index.js</strong> </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Terminal&#125; <span class="keyword">from</span> <span class="string">'xterm'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> attach <span class="keyword">from</span> <span class="string">'xterm/lib/addons/attach/attach'</span>;</span><br><span class="line"></span><br><span class="line">Terminal.applyAddon(attach);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> term = <span class="keyword">new</span> Terminal();</span><br><span class="line">term.open(<span class="built_in">document</span>.getElementById(<span class="string">'#terminal'</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ws_host = <span class="string">"192.168.0.4:2375"</span>;</span><br><span class="line"><span class="keyword">var</span> container = <span class="string">"test"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ws = <span class="string">"ws://"</span> + ws_host + <span class="string">"/containers/"</span> + container + <span class="string">"/attach/ws?stream=true"</span>;</span><br><span class="line"><span class="keyword">var</span> socket = <span class="keyword">new</span> WebSocket(ws);</span><br><span class="line"></span><br><span class="line">term.attach(socket);</span><br></pre></td></tr></table></figure>
<p>ws 的 URL，实际是 docker engine 的 API，需要注意的是，需要将 <code>stream</code> 设置为 <code>true</code>，不然即使连接上，也是无法传递数据的。</p>
<img src="/2019-05/use-xterm-js-attach-to-docker-container/2019-05-09_docker_ws_api.jpg">
<p>▲ docker websocket API</p>
<p>接着在项目 root 目录下新建 index.html。</p>
<p><strong>index.html</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"node_modules/xterm/dist/xterm.css"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"node_modules/xterm/dist/xterm.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hey!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"terminal"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"dist/bundle.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>到这里，所有的关键代码已经准备好了。</p>
<img src="/2019-05/use-xterm-js-attach-to-docker-container/2019-05-09_xterm_attach_tree.jpg">
<p>▲ 项目目录结构</p>
<h2 id="测试-1"><a href="#测试-1" class="headerlink" title="测试"></a>测试</h2><p>首先运行一个容器。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name <span class="built_in">test</span> -itd ubuntu:latest bash</span><br></pre></td></tr></table></figure>
<p>在项目 root 目录执行 <code>npm run dev</code>，进行调试。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure>
<img src="/2019-05/use-xterm-js-attach-to-docker-container/2019-05-09_xterm_attach.jpg">
<p>▲ xterm.js 接入 docker 容器效果</p>
<h1 id="关于-xterm-js-attach-到容器"><a href="#关于-xterm-js-attach-到容器" class="headerlink" title="关于 xterm.js attach 到容器"></a>关于 xterm.js attach 到容器</h1><p>docker engine 的 API 里面提供了两个 attach 到容器的方法。一个是和其他 API 一样使用 HTTP 协议的 attach，另一个为使用 websocket 协议的 attach。</p>
<p>在上面的说明（docker api的截图）中可以看到，docker engine 的 API 里面并没有对 websocket 有过多的解释。实际上，websocket 协议的 attach 和 HTTP 协议的 attche在“原理”上是一样的，只是他们的数据的传输方式不一样。</p>
<h2 id="docker-attach"><a href="#docker-attach" class="headerlink" title="docker attach"></a>docker attach</h2><img src="/2019-05/use-xterm-js-attach-to-docker-container/2019-05-09_docker_attach.jpg">
<p>▲ docker attach 的解释</p>
<p>实际是 docker attach 是 “attach” 到容器创建时的 <code>ENTRYPOINT/CMD</code> 命令的进程（默认指PID 1进程）。如果在容器创建时通过 <code>-i</code> 让容器保持打开 <code>stdin</code>，“attach” 到容器后将可以与容器进行“交互”（如果条件合适）。</p>
<h3 id="关于-i"><a href="#关于-i" class="headerlink" title="关于 -i"></a>关于 <code>-i</code></h3><p><em>Keep STDIN open even if not attached.</em></p>
<p><code>-i</code> 有两个作用；一、是会让容器保持stdin开放，二是、同时也会 attach 到容器的 stdin（即使通过 <code>-a</code> 指定 attach 到 stdxx）。</p>
<blockquote>
<p>注：<code>-t</code>是给容器分配一个虚拟终端，也是关键。</p>
</blockquote>
<p>docker create 或 exec 指定的 commond 会通过 stdin （这里应该是 API -&gt; docker engine -&gt; container，不过我简略了）在容器内执行，执行这“一次”结束后容器，将会关闭“此次”的 stdin；如果是使用 <code>-i</code>，将会保持stdin打开；要是commond进程可以交互，用户则可以输入命令，命令将继续通过开放stdin在容器内执行。</p>
<p>如上所述，attach 最终能不能交互还得看<code>ENTRYPOINT/CMD</code> 命令的进程自身有没有“交互”的功能，比如可以交互的有 <code>bash</code>、<code>top</code>，不能交互的有 <code>ls</code>等。</p>
<h2 id="xterm-js-attach-的局限"><a href="#xterm-js-attach-的局限" class="headerlink" title="xterm.js attach 的局限"></a>xterm.js attach 的局限</h2><p>到这里可以得出结论，xterm.js attach 到容器，最终能不能进行交互，和容器的 <code>ENTRYPOINT/CMD</code> 的命令有很大的关系。如果在创建容器时没指定 <code>-it</code> 或者 <code>ENTRYPOINT/CMD</code> 不是 <code>bash</code> 之类的可交互进程，xterm.js 虽然可以连接到容器，但都不可以与容器进行交互的。</p>
<p>而实际情况是，绝大多数的容器事务，这两个条件都没有。</p>
<h2 id="xterm-js-连接到容器的解决方案"><a href="#xterm-js-连接到容器的解决方案" class="headerlink" title="xterm.js 连接到容器的解决方案"></a>xterm.js 连接到容器的解决方案</h2><p>使用 <code>exec</code>。</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a href="https://xtermjs.org/docs/" target="_blank" rel="noopener">https://xtermjs.org/docs/</a></li>
<li><a href="https://docs.docker.com/engine/api/v1.39/#operation/ContainerAttachWebsocket" target="_blank" rel="noopener">https://docs.docker.com/engine/api/v1.39/#operation/ContainerAttachWebsocket</a></li>
<li><a href="https://docs.docker.com/engine/reference/commandline/attach/" target="_blank" rel="noopener">https://docs.docker.com/engine/reference/commandline/attach/</a></li>
</ul>
</div><div class="uni-update"><li class="fa fa-hourglass-half"> Update: 2019-05-09 07:55:31</li></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>Author: </strong>unihon</li><li class="post-copyright-link"><strong>Blog Link: </strong><a href="/2019-05/use-xterm-js-attach-to-docker-container/">https://unihon.github.io/2019-05/use-xterm-js-attach-to-docker-container/</a></li><li class="post-copyright-license"><strong>Copyright Declaration: </strong>The author owns the copyright. Please indicate the source reproduced!</li></ul></div><br><div class="tags"><a href="/tags/API/">API</a><a href="/tags/xterm-js/">xterm.js</a></div><div class="post-nav"><a class="pre" href="/2019-06/update-html-syntax-indentation-on-vim7/">update-html-syntax-indentation-on-vim7</a><a class="next" href="/2019-04/directly-use-docker-s-unix-socket-type-api/">directly-use-docker-s-unix-socket-type-api</a></div></div></div></div><div class="pure-u-1-4 toc-and-sidebar"><div id="sidebar"><div class="toc-switch"></div><div id="hon-toc"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#xterm-js"><span class="toc-number">1.</span> <span class="toc-text">xterm.js</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#xterm-js-插件"><span class="toc-number">1.1.</span> <span class="toc-text">xterm.js 插件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用-xterm-js-接入-linux"><span class="toc-number">2.</span> <span class="toc-text">使用 xterm.js 接入 linux</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#步骤"><span class="toc-number">2.1.</span> <span class="toc-text">步骤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试"><span class="toc-number">2.2.</span> <span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用-xterm-js-attach-到-docker-容器"><span class="toc-number">3.</span> <span class="toc-text">使用 xterm.js attach 到 docker 容器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#步骤-1"><span class="toc-number">3.1.</span> <span class="toc-text">步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#配置-package-json-和-webpack"><span class="toc-number">3.1.1.</span> <span class="toc-text">配置 package.json 和 webpack</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试-1"><span class="toc-number">3.2.</span> <span class="toc-text">测试</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#关于-xterm-js-attach-到容器"><span class="toc-number">4.</span> <span class="toc-text">关于 xterm.js attach 到容器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-attach"><span class="toc-number">4.1.</span> <span class="toc-text">docker attach</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#关于-i"><span class="toc-number">4.1.1.</span> <span class="toc-text">关于 -i</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xterm-js-attach-的局限"><span class="toc-number">4.2.</span> <span class="toc-text">xterm.js attach 的局限</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xterm-js-连接到容器的解决方案"><span class="toc-number">4.3.</span> <span class="toc-text">xterm.js 连接到容器的解决方案</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#参考"><span class="toc-number">5.</span> <span class="toc-text">参考</span></a></li></ol></div></div><div id="blog-sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Config/">Config</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Database/">Database</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/">Development</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mix/">Mix</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a><span class="category-list-count">6</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/boot2docker/" style="font-size: 15px;">boot2docker</a> <a href="/tags/about/" style="font-size: 15px;">about</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/web-spider/" style="font-size: 15px;">web-spider</a> <a href="/tags/WSL/" style="font-size: 15px;">WSL</a> <a href="/tags/frp/" style="font-size: 15px;">frp</a> <a href="/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/tags/csv/" style="font-size: 15px;">csv</a> <a href="/tags/bootstrap4/" style="font-size: 15px;">bootstrap4</a> <a href="/tags/validation/" style="font-size: 15px;">validation</a> <a href="/tags/ajax/" style="font-size: 15px;">ajax</a> <a href="/tags/thread/" style="font-size: 15px;">thread</a> <a href="/tags/Vim/" style="font-size: 15px;">Vim</a> <a href="/tags/tmux/" style="font-size: 15px;">tmux</a> <a href="/tags/asciinema/" style="font-size: 15px;">asciinema</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/partition/" style="font-size: 15px;">partition</a> <a href="/tags/lvm/" style="font-size: 15px;">lvm</a> <a href="/tags/VirtualBox/" style="font-size: 15px;">VirtualBox</a> <a href="/tags/shell/" style="font-size: 15px;">shell</a> <a href="/tags/bootloader/" style="font-size: 15px;">bootloader</a> <a href="/tags/grub2/" style="font-size: 15px;">grub2</a> <a href="/tags/uefi/" style="font-size: 15px;">uefi</a> <a href="/tags/bash/" style="font-size: 15px;">bash</a> <a href="/tags/stty/" style="font-size: 15px;">stty</a> <a href="/tags/hotkey/" style="font-size: 15px;">hotkey</a> <a href="/tags/network/" style="font-size: 15px;">network</a> <a href="/tags/translation/" style="font-size: 15px;">translation</a> <a href="/tags/statement/" style="font-size: 15px;">statement</a> <a href="/tags/picture/" style="font-size: 15px;">picture</a> <a href="/tags/formats/" style="font-size: 15px;">formats</a> <a href="/tags/automation/" style="font-size: 15px;">automation</a> <a href="/tags/characters/" style="font-size: 15px;">characters</a> <a href="/tags/title/" style="font-size: 15px;">title</a> <a href="/tags/communicate/" style="font-size: 15px;">communicate</a> <a href="/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/tags/unihon/" style="font-size: 15px;">unihon</a> <a href="/tags/docker-machine/" style="font-size: 15px;">docker-machine</a> <a href="/tags/LNMP/" style="font-size: 15px;">LNMP</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Nginx/" style="font-size: 15px;">Nginx</a> <a href="/tags/Mariadb/" style="font-size: 15px;">Mariadb</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/command/" style="font-size: 15px;">command</a> <a href="/tags/Dockerfile/" style="font-size: 15px;">Dockerfile</a> <a href="/tags/Config/" style="font-size: 15px;">Config</a> <a href="/tags/PID-1/" style="font-size: 15px;">PID-1</a> <a href="/tags/process/" style="font-size: 15px;">process</a> <a href="/tags/iptables/" style="font-size: 15px;">iptables</a> <a href="/tags/CentOS/" style="font-size: 15px;">CentOS</a> <a href="/tags/init/" style="font-size: 15px;">init</a> <a href="/tags/TLS/" style="font-size: 15px;">TLS</a> <a href="/tags/HTTPS/" style="font-size: 15px;">HTTPS</a> <a href="/tags/certificate/" style="font-size: 15px;">certificate</a> <a href="/tags/CA/" style="font-size: 15px;">CA</a> <a href="/tags/API/" style="font-size: 15px;">API</a> <a href="/tags/OpenSSL/" style="font-size: 15px;">OpenSSL</a> <a href="/tags/HTML/" style="font-size: 15px;">HTML</a> <a href="/tags/syntax/" style="font-size: 15px;">syntax</a> <a href="/tags/indent/" style="font-size: 15px;">indent</a> <a href="/tags/Vue/" style="font-size: 15px;">Vue</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a> <a href="/tags/CORS/" style="font-size: 15px;">CORS</a> <a href="/tags/VSCode/" style="font-size: 15px;">VSCode</a> <a href="/tags/Resource/" style="font-size: 15px;">Resource</a> <a href="/tags/CPU/" style="font-size: 15px;">CPU</a> <a href="/tags/Memory/" style="font-size: 15px;">Memory</a> <a href="/tags/Tranvis-CI/" style="font-size: 15px;">Tranvis-CI</a> <a href="/tags/github-pages/" style="font-size: 15px;">github-pages</a> <a href="/tags/HTTP/" style="font-size: 15px;">HTTP</a> <a href="/tags/socket/" style="font-size: 15px;">socket</a> <a href="/tags/Python/" style="font-size: 15px;">Python</a> <a href="/tags/xterm-js/" style="font-size: 15px;">xterm.js</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019-08/specify-memory-and-cpu-of-the-container/">specify-memory-and-cpu-of-the-container</a></li><li class="post-list-item"><a class="post-list-link" href="/2019-07/vs-code-remote-development/">vs-code-remote-development</a></li><li class="post-list-item"><a class="post-list-link" href="/2019-07/vue-cli-3-use-webpack-devserver-proxy-to-solve-cors/">vue-cli-3-use-webpack-devserver-proxy-to-solve-cors</a></li><li class="post-list-item"><a class="post-list-link" href="/2019-06/update-html-syntax-indentation-on-vim7/">update-html-syntax-indentation-on-vim7</a></li><li class="post-list-item"><a class="post-list-link" href="/2019-05/use-xterm-js-attach-to-docker-container/">use-xterm-js-attach-to-docker-container</a></li><li class="post-list-item"><a class="post-list-link" href="/2019-04/directly-use-docker-s-unix-socket-type-api/">directly-use-docker-s-unix-socket-type-api</a></li><li class="post-list-item"><a class="post-list-link" href="/2019-04/use-the-tls-protect-docker-api/">use-the-tls-protect-docker-api</a></li><li class="post-list-item"><a class="post-list-link" href="/2019-04/docker-api-https-installa-the-certificate-on-windows/">docker-api-https-installa-the-certificate-on-windows</a></li><li class="post-list-item"><a class="post-list-link" href="/2019-04/the-problem-of-amh-iptables/">the-problem-of-amh-iptables</a></li><li class="post-list-item"><a class="post-list-link" href="/2019-04/docker-pid-1-and-container-stop/">docker-pid-1-and-container-stop</a></li></ul></div></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">unihon's.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.2.2" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.2.2" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.2.2"></script><script>var search_path = 'search/search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.2.2"></script><script type="text/javascript" src="/js/smartresize.js?v=0.2.2"></script><script type="text/javascript" src="/js/tocjs.js?v=0.2.2"></script></div></body></html>